# Телеграм-бот для координации доноров НИЯУ МИФИ
https://t.me/donor_mifi_bot
Это многофункциональный Телеграм-бот, созданный для автоматизации и упрощения работы с донорским движением в НИЯУ МИФИ. Он предоставляет удобный интерфейс как для доноров, так и для организаторов мероприятий.

## Основные возможности

### Для доноров:
- **Быстрая регистрация** по номеру телефона с указанием категории (Студент, Сотрудник, Внешний донор).
- **Запись на Дни Донора** из списка активных мероприятий.
- **Личный кабинет** с персональной статистикой донаций и историей записей.
- **Информационный раздел** с данными о донорстве.
- **Прямая связь с организаторами** для решения возникающих вопросов.

### Для администраторов:
- **Панель управления**, доступная по команде `/admin`.
- **Управление базой доноров:** добавление, поиск по номеру телефона и редактирование данных.
- **Выгрузка** всей базы доноров в виде Excel-файла.
- **Управление мероприятиями:** создание новых Дней Донора, которые сразу становятся доступны для записи.
- **Автоматическая обработка статистики:** загрузка Excel-файла с результатами прошедшего мероприятия для автоматического обновления данных о донациях у каждого участника.

## Технологический стек
- **Язык:** Python 3.10+
- **Основной фреймворк:** `aiogram 3.x`
- **Работа с данными:** `pandas` и `openpyxl` для взаимодействия с Excel-файлом.
- **База данных:** Вся информация хранится в файле `donors.xlsx`.

## Структура проекта

```
.
├── donors.xlsx         # Файл базы данных (доноры, мероприятия, регистрации)
├── requirements.txt    # Список зависимостей Python
├── src/                # Папка с исходным кодом
│   └── main.py         # Основной и единственный файл с логикой бота
└── README.md           # Этот файл
```

- **`donors.xlsx`**: Сердце проекта. Содержит несколько листов для хранения всей информации:
  - `Sheet1`: Основная база доноров с их данными (ФИО, контакты, статистика).
  - `events`: Список всех Дней Донора.
  - `registrations`: Записи пользователей на мероприятия.
- **`src/main.py`**: Здесь находится вся логика: обработчики команд, машина состояний (FSM) для диалогов, функции для работы с Excel-файлом и вся логика административной панели.

## Установка и запуск

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <URL_вашего_репозитория>
    cd donor_bot
    ```

2.  **Создайте и активируйте виртуальное окружение** (рекомендуется):
    ```bash
    python -m venv venv
    # Для Windows:
    venv\Scripts\activate
    # Для macOS/Linux:
    source venv/bin/activate
    ```

3.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **Настройте переменные окружения:**
    В файле `src/main.py` необходимо указать токен вашего бота. Рекомендуется не хранить его в коде, а использовать переменные окружения.

    - **Токен бота:** Найдите строку `bot = Bot(token='...')` и вставьте ваш токен, полученный от [@BotFather](https://t.me/BotFather).
    - **ID администраторов:** В списке `ADMIN_IDS = [...]` укажите числовые ID администраторов, которые будут иметь доступ к админ-панели.
    - **ID чата для вопросов:** Убедитесь, что переменная `ADMIN_CHAT_ID` установлена верно. Это ID группового чата, куда бот будет пересылать вопросы от пользователей.

5.  **Запустите бота:**
    ```bash
    python src/main.py
    ```

После запуска бот готов к работе. При первом запуске он автоматически создаст файл `donors.xlsx` с необходимой структурой, если тот отсутствует.
